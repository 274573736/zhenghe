<?php
 use app\common\model\Category; use fast\Form; use fast\Tree; use think\Db; goto lU5u1; TzrIq: function get_access_token($uniacid = 0) { goto Yma6U; DAum_: $arr = json_decode($html, true); goto ITWIE; AI9SY: $uniacid = !empty($uniacid) ? intval($uniacid) : $GLOBALS["\x75\156\151\141\143\x69\x64"]; goto d224t; Pc6YP: $tokenUrl = "\150\164\164\x70\163\72\57\x2f\x61\160\x69\56\x77\145\x69\x78\x69\x6e\56\161\x71\56\x63\157\155\x2f\x63\147\151\x2d\142\151\x6e\x2f\x74\157\x6b\145\x6e\77\147\x72\141\156\164\x5f\164\171\160\145\75\143\154\151\x65\156\x74\137\x63\x72\145\144\145\x6e\x74\151\141\154\46\x61\160\x70\x69\144\75" . $uni["\x6b\145\171"] . "\46\163\145\143\x72\x65\164\75" . $uni["\x73\145\x63\162\145\x74"]; goto GZfuG; GZfuG: $html = file_get_contents($tokenUrl); goto DAum_; Yma6U: global $_W; goto AI9SY; ITWIE: return !empty($arr["\x61\143\x63\145\163\163\x5f\x74\x6f\153\x65\x6e"]) ? $arr["\x61\x63\143\x65\x73\163\137\x74\157\x6b\145\156"] : $arr; goto NH8OB; fNhKA: if (!empty($uni)) { goto Sp9NG; } goto ehOPf; CVELZ: $uni = Db::table($tablepre . "\x61\x63\143\x6f\x75\156\x74\x5f\167\170\x61\160\160")->where(array("\x75\x6e\x69\141\x63\151\x64" => $uniacid))->field("\x6b\x65\171\x2c\163\145\x63\x72\145\164")->find(); goto fNhKA; HkQNd: Sp9NG: goto Pc6YP; d224t: $tablepre = !empty($_W["\x63\157\x6e\x66\151\147"]["\144\142"]["\x74\x61\x62\154\x65\x70\162\145"]) ? $_W["\143\157\156\146\x69\147"]["\144\x62"]["\x74\141\x62\154\145\160\162\x65"] : "\x69\x6d\163\137"; goto CVELZ; ehOPf: return false; goto HkQNd; NH8OB: } goto mJcQU; cevLQ: if (!function_exists("\142\x75\151\x6c\144\x5f\143\x61\x74\x65\x67\157\162\171\137\163\x65\x6c\x65\x63\x74")) { function build_category_select($name, $type, $selected = null, $attr = array(), $header = array()) { goto QC2PX; N8rwT: $tree->init(Category::getCategoryArray($type), "\160\151\x64"); goto CmMBE; CmMBE: $categorylist = $tree->getTreeList($tree->getTreeArray(0), "\156\x61\x6d\x65"); goto D5IIq; QC2PX: $tree = Tree::instance(); goto N8rwT; D5IIq: $categorydata = $header ? $header : []; goto Ap1Kz; RNWkL: return build_select($name, $categorydata, $selected, $attr); goto RcPsw; om0kw: oN3fM: goto ODa_b; ODa_b: $attr = array_merge(["\151\x64" => "\x63\55{$name}", "\143\154\141\x73\163" => "\146\157\162\x6d\55\143\157\x6e\x74\x72\157\x6c\40\x73\x65\x6c\x65\x63\x74\x70\x69\143\153\x65\x72"], $attr); goto RNWkL; Ap1Kz: foreach ($categorylist as $k => $v) { $categorydata[$v["\151\x64"]] = $v["\x6e\x61\x6d\x65"]; n70pw: } goto om0kw; RcPsw: } } goto k72af; LXHmC: function addUserCashLog($user_id, $order_code, $amount, $type = 0, $title = '', $status = 1, $object_id = 0, $business_id = 0) { goto TIfvV; TIfvV: $data = array("\x74\151\164\x6c\145" => !empty($title) ? $title : '', "\x62\x75\x73\151\156\145\x73\x73\137\x69\x64" => $business_id, "\x75\x73\145\x72\x5f\151\144" => intval($user_id), "\157\142\x6a\x65\x63\164\x5f\151\144" => $object_id, "\x6f\162\x64\145\x72\x5f\143\x6f\x64\145" => $order_code, "\141\x6d\157\165\156\164" => sprintf("\x25\56\62\x66", $amount), "\164\x79\160\145" => intval($type), "\x73\164\x61\x74\165\x73" => $status, "\141\144\x64\137\164\151\155\x65" => time(), "\165\156\x69\141\x63\x69\x64" => !empty($GLOBALS["\165\x6e\x69\141\x63\151\x64"]) ? $GLOBALS["\165\x6e\151\141\x63\x69\x64"] : 0); goto Fa5wJ; d1pEe: return true; goto ocVT_; xGdN4: return false; goto EvxcS; Fa5wJ: $add = Db::name("\165\163\145\162\137\143\141\x73\x68\154\x6f\147")->insert($data); goto OuSG1; OuSG1: if (empty($add)) { goto QA5L1; } goto d1pEe; ocVT_: QA5L1: goto xGdN4; EvxcS: } goto fkZ7f; Gmqmf: function getXMLData($xml) { goto v3NTU; Nc1p8: foreach ($data as $k => $v) { $results[$k] = (string) $v; s9qEs: } goto RT4bE; BMSKr: return $results; goto sZ_Xv; v3NTU: if (!function_exists("\163\151\155\x70\154\x65\170\x6d\154\x5f\154\157\141\x64\x5f\163\x74\x72\x69\x6e\147")) { return array(); } goto x9Mv9; A4ggL: $results = array(); goto Nc1p8; RT4bE: Ej1Zj: goto BMSKr; x9Mv9: $data = simplexml_load_string($xml); goto ThXlh; BNj6u: return array(); goto LRovm; LRovm: WEfCs: goto A4ggL; ThXlh: if (!($data === false)) { goto WEfCs; } goto BNj6u; sZ_Xv: } goto QuC8M; QuC8M: function weixinRefund($order_code, $amount, $user_id = 0, $module = "\155\141\153\145\137\163\160\145\x65\x64") { goto KWtxi; KzW8O: DSb5j: goto X3tXz; KeLXp: $keyPath = ROOT_PATH . "\57\160\165\142\x6c\x69\x63\x2f\x75\160\x6c\x6f\x61\144\163\x2f" . $user_id . "\x5f\142\157\x6d\x76\156\x6a\172\x79\x7a\144\x6d\x7a\x62\x74\x68\x64\56\x70\x65\x6d"; goto oues4; gA6HY: if (!empty($data["\x73\x69\x67\x6e"])) { goto RCb4_; } goto ktFBO; ZKWwl: $data = setXMLData($data); goto JehEK; xRf9H: $result = getXMLData($result); goto UMHrJ; o3DXR: return array(1, !empty($result["\x65\x72\162\137\x63\157\x64\x65\x5f\144\145\163"]) ? $result["\x65\162\162\137\143\x6f\144\145\137\144\x65\x73"] : ''); goto By2eh; iIJ_L: return array(1, "\350\256\242\xe5\215\225\345\217\xb7\351\x94\231\350\257\xaf\357\xbc\x81\xe8\257\267\xe7\250\215\345\x90\x8e\xe9\207\x8d\350\xaf\x95"); goto GG1IC; PqnDd: if (!empty($paylog)) { goto EDg6u; } goto hBr5k; G4I9U: $result = setRequest($url, $data, true, $certPath, $keyPath); goto QgafZ; lNVQl: is_file($keyPath) && unlink($keyPath); goto xRf9H; mosc7: return array(1, "\346\x9c\252\346\x89\xbe\xe5\x88\xb0\345\xb0\217\xe7\250\x8b\345\xba\x8f\xef\274\201"); goto R7MdU; D6r9N: if (!(empty($mcd) || empty($mcd["\x77\145\143\x68\141\164"]["\x6d\x63\x68\151\144"]) || empty($mcd["\x77\x65\143\150\x61\164"]["\163\x69\x67\x6e\x6b\145\171"]))) { goto IXIwd; } goto MiaHL; UMHrJ: if (!(empty($result) || strtolower($result["\x72\145\x74\x75\162\156\137\x63\157\x64\145"]) !== "\163\165\143\x63\x65\x73\x73")) { goto HwUb8; } goto LVRNe; cVh78: if (!empty($amount)) { goto By6U7; } goto P1meq; LkOfg: $mcd = array(); goto ML3nn; R7MdU: lGyZ5: goto eewWl; K8GVc: IXIwd: goto cDiNg; mfrKQ: if (!empty($order_code)) { goto xlVxn; } goto iIJ_L; KWtxi: global $_W; goto mfrKQ; ddcAK: if (!(empty($result["\x72\x65\x73\x75\154\x74\137\143\157\144\145"]) || strtolower($result["\x72\x65\163\x75\x6c\x74\137\143\x6f\x64\145"]) !== "\163\165\143\x63\x65\x73\x73")) { goto gyrcu; } goto o3DXR; VDYzd: WE10Z: goto nVZVF; MMztM: EDg6u: goto XEhnP; P1meq: return array(1, "\350\257\xb7\351\x80\x89\xe6\213\251\xe8\xbe\x93\xe5\205\245\351\200\x80\xe6\xac\276\351\207\221\xe9\xa2\x9d\345\220\x8e\xe9\x87\x8d\xe8\xaf\225\357\274\x81"); goto dSdRD; nVZVF: $data = array("\x61\x70\160\x69\x64" => $wxapp["\153\145\171"], "\155\143\150\x5f\151\x64" => $mcd["\167\145\143\x68\141\164"]["\x6d\143\x68\x69\144"], "\157\x75\x74\137\164\x72\x61\144\145\137\156\157" => $paylog["\165\x6e\151\x6f\x6e\164\151\144"], "\157\165\x74\137\162\145\x66\x75\156\144\137\156\x6f" => $refund_uniontid, "\164\x6f\164\x61\154\137\x66\145\x65" => $amount * 100, "\x72\x65\x66\x75\x6e\x64\137\x66\x65\145" => $amount * 100, "\x6e\x6f\x6e\143\x65\137\x73\164\162" => random(8), "\x72\145\x66\x75\x6e\144\x5f\144\x65\163\x63" => "\345\217\226\346\266\x88\350\256\xa2\xe5\x8d\x95\xe9\x80\x80\xe6\254\276"); goto LbzNu; LVRNe: return array(1, !empty($result["\162\145\x74\x75\x72\156\137\x6d\163\147"]) ? $result["\162\x65\164\x75\162\x6e\137\155\163\x67"] : "\55"); goto W0buh; zstBL: return array(0, ''); goto kXmCG; By2eh: gyrcu: goto zstBL; X3tXz: $certPath = ROOT_PATH . "\57\x70\x75\x62\x6c\x69\143\57\x75\160\x6c\x6f\141\x64\x73\57" . $user_id . "\137\x65\165\x65\162\x6d\151\64\x6c\142\172\144\63\161\163\x6d\61\155\172\x68\x79\56\x70\x65\x6d"; goto KeLXp; dSdRD: By6U7: goto g_B56; cDiNg: if (!(empty($mcd["\167\x65\x63\150\x61\164\137\162\145\x66\165\156\144"]["\143\145\x72\x74"]) || empty($mcd["\167\145\x63\150\x61\164\x5f\x72\x65\x66\x75\156\144"]["\153\x65\x79"]))) { goto iEqC9; } goto V4qei; ML3nn: !empty($res[0]) && !empty($res[0]) && ($mcd = unserialize($res[0])); goto D6r9N; bFZub: file_put_contents($keyPath, authcode($mcd["\x77\145\x63\x68\141\164\x5f\x72\x65\x66\165\x6e\x64"]["\153\x65\171"], "\x44\105\103\117\104\105")); goto VDYzd; hBr5k: return array(1, "\xe6\xad\244\xe6\224\257\xe4\273\230\xe8\xae\xa2\345\x8d\x95\344\xb8\x8d\345\255\x98\xe5\x9c\250"); goto MMztM; vjtpB: iEqC9: goto q0JVB; eewWl: if (!(!empty($certPath) && !empty($keyPath))) { goto WE10Z; } goto Jb3VN; GG1IC: xlVxn: goto cVh78; q0JVB: $wxapp = Db::table($_W["\143\157\156\x66\x69\147"]["\144\142"]["\164\x61\142\154\x65\x70\x72\x65"] . "\x61\x63\143\x6f\x75\x6e\x74\x5f\167\170\141\160\160")->where(array("\x75\156\151\x61\x63\x69\144" => $GLOBALS["\x75\156\151\x61\143\151\144"]))->find(); goto LSJyA; Q_GTd: RCb4_: goto ZKWwl; XEhnP: if (!($paylog["\x73\164\141\164\165\163"] != 1)) { goto DSb5j; } goto NTsX3; QgafZ: is_file($certPath) && unlink($certPath); goto lNVQl; NTsX3: return array(1, "\346\xad\244\350\xae\242\xe5\x8d\x95\xe8\277\230\xe6\234\xaa\346\224\xaf\344\xbb\230\346\210\220\345\212\x9f\xe4\xb8\215\xe5\217\xaf\xe9\200\200\xe6\xac\xbe"); goto KzW8O; oues4: $res = Db::table($_W["\143\157\156\x66\x69\147"]["\144\142"]["\164\x61\142\154\x65\160\162\x65"] . "\165\x6e\151\x5f\x73\145\x74\x74\x69\x6e\147\163")->where("\x75\156\151\x61\x63\x69\144", $GLOBALS["\x75\156\151\141\x63\x69\x64"])->column("\160\141\171\x6d\x65\156\x74"); goto LkOfg; Z5W4j: $paylog = Db::table($_W["\x63\x6f\x6e\x66\151\147"]["\144\x62"]["\164\141\142\154\145\x70\x72\145"] . "\143\157\x72\145\137\160\141\x79\x6c\157\x67")->where(array("\x75\x6e\x69\x61\143\x69\x64" => $GLOBALS["\165\156\151\141\143\x69\x64"], "\x6d\157\144\x75\x6c\145" => $module, "\x74\x69\x64" => $order_code))->find(); goto PqnDd; g_B56: $refund_uniontid = date("\131\155\144\110\x69\163") . 00 . random(8, 1); goto Z5W4j; W0buh: HwUb8: goto ddcAK; ktFBO: return array(1, "\xe6\x95\260\xe5\255\227\xe7\xad\xbe\345\220\215\xe7\x94\x9f\346\210\220\345\244\xb1\350\xb4\xa5\357\274\201"); goto Q_GTd; MiaHL: return array(1, "\xe6\x9c\252\xe9\x85\x8d\xe7\275\256\xe5\xbe\256\xe4\277\xa1\346\224\xaf\xe4\273\230\357\xbc\x81"); goto K8GVc; LbzNu: $data["\x73\151\x67\x6e"] = generateDataSign($data, "\x6d\144\65", $mcd["\x77\x65\143\x68\141\164"]["\x73\151\147\156\153\x65\x79"]); goto gA6HY; JehEK: $url = "\x68\164\x74\160\x73\72\57\57\x61\160\x69\x2e\155\143\150\x2e\167\145\x69\x78\151\x6e\x2e\161\161\x2e\143\x6f\x6d\57\163\x65\x63\141\x70\x69\57\160\141\x79\x2f\x72\145\146\165\156\144"; goto G4I9U; LSJyA: if (!(empty($wxapp) || empty($wxapp["\x6b\145\x79"]))) { goto lGyZ5; } goto mosc7; Jb3VN: file_put_contents($certPath, authcode($mcd["\x77\x65\x63\x68\x61\x74\137\162\145\146\165\x6e\144"]["\x63\145\162\x74"], "\104\x45\103\x4f\104\x45")); goto bFZub; V4qei: return array(1, "\xe8\xaf\xb7\xe5\274\x80\xe5\220\xaf\345\276\xae\xe4\xbf\xa1\351\x80\x80\346\254\276\54\xe5\271\266\351\205\x8d\347\xbd\xae\344\xb8\212\344\274\xa0\xe8\257\x81\344\271\xa6\xef\xbc\201"); goto vjtpB; kXmCG: } goto AqJjU; AqJjU: function toint($value) { goto tln1g; PLJ5J: return intval($value); goto cktw7; tln1g: is_numeric($value) || ($value = intval($value)); goto uiR32; Kuuzh: return sprintf("\45\x2e\62\x66", $value); goto V2gqh; V2gqh: vctl6: goto PLJ5J; uiR32: if (!(ceil($value) > intval($value))) { goto vctl6; } goto Kuuzh; cktw7: } goto kwV4E; Kojdk: function addRiderCashLog($rider_id, $amount, $title = '', $type = 1, $status = 0, $order_code = '', $object_id = 0) { goto h6pWa; v2qml: return $add; goto Kqalx; LmNgu: $add = Db::name("\x72\151\x64\x65\x72\137\x63\141\163\150\154\157\x67")->insert($data); goto v2qml; hvwBx: $data["\x74\151\164\154\x65"] == '' && ($data["\x74\151\x74\x6c\x65"] = $type == 0 ? "\xe5\207\x8f\xe5\xb0\x91" : "\xe5\xa2\236\345\212\240"); goto LmNgu; h6pWa: $data = array("\x74\151\x74\154\x65" => !empty($title) ? $title : '', "\162\x69\x64\145\162\137\x69\144" => intval($rider_id), "\x6f\142\152\x65\x63\x74\137\x69\x64" => $object_id, "\x6f\162\x64\145\x72\137\x63\x6f\144\145" => $order_code, "\141\x6d\x6f\165\x6e\164" => sprintf("\x25\56\62\x66", $amount), "\x74\171\x70\145" => intval($type), "\163\164\141\164\x75\163" => $status, "\x61\144\144\137\x74\x69\155\x65" => time(), "\x75\156\151\x61\x63\151\144" => !empty($GLOBALS["\165\x6e\x69\141\143\151\x64"]) ? $GLOBALS["\165\156\x69\x61\x63\151\144"] : 0); goto hvwBx; Kqalx: } goto TzrIq; mJcQU: function update_business_money($bid, $amount, $type = 0) { goto dx0L4; zWdR9: $up = Db::name("\x62\x75\x73\151\156\x65\x73\x73")->where(["\x69\144" => $bid])->setInc("\166\141\x6c\x69\144", $amount); goto xscWB; dNh6K: $up = Db::name("\x62\165\163\x69\156\145\163\x73")->where(["\x69\144" => $bid])->setDec("\166\141\x6c\151\144", $amount); goto lQ42U; JgaCV: return false; goto BiGwb; e2pXQ: n5iAq: goto dNh6K; lQ42U: rbWEj: goto oIy8V; xscWB: goto rbWEj; goto e2pXQ; oIy8V: if (empty($up)) { goto dZMvj; } goto ylFPI; D7G8l: if (!(empty($business) || $business["\x76\141\x6c\151\144"] <= 0)) { goto pa7Q_; } goto geDkk; ylFPI: return true; goto LjHst; LjHst: dZMvj: goto JgaCV; geDkk: return false; goto v5i7K; v5i7K: pa7Q_: goto cvS_R; dx0L4: $business = Db::name("\142\165\163\151\x6e\145\163\x73")->where(["\x69\144" => $bid])->field("\x76\141\x6c\x69\144")->find(); goto D7G8l; cvS_R: if (empty($type)) { goto n5iAq; } goto zWdR9; BiGwb: } goto ZWxAr; ZWxAr: function update_eleme_order($order_code, $business, $mobile, $status = "\x44\x45\114\x49\126\105\122\x59\x5f\x53\124\101\x52\124") { goto GaXcz; xE03V: $result = $ele->call("\x65\154\x65\x6d\145\x2e\157\162\144\x65\162\x2e\163\145\x6c\x66\104\x65\154\x69\166\x65\162\171\123\x74\141\x74\145\x53\171\x6e\143", $param); goto VsAun; oAgKB: $sandbox = "\163\141\x6e\x64\142\x6f\170"; goto S75Hi; lmc9r: $param = array("\x73\x68\157\160\x49\144" => $business["\163\150\157\x70\x5f\x69\144"], "\163\164\141\164\x65\111\156\146\x6f" => array("\157\x72\x64\145\x72\111\144" => str_replace("\x42", '', $order_code), "\x64\151\163\x74\x72\x69\x62\x75\x74\157\x72\111\x64" => 201, "\x6b\x6e\x69\147\150\x74" => array("\x69\x64" => $mobile, "\160\150\157\156\145" => $mobile, "\x6e\141\155\x65" => "\345\225\x86\xe5\256\266\xe8\x87\252\351\205\215\xe9\200\x81"), "\163\164\141\164\x65" => $status)); goto xE03V; GaXcz: vendor("\145\154\x65\155\x65\x2e\x45\x6c\145\x6d\x65\141\x70\x69"); goto PbJMp; u8H5H: RRJLa: goto VCVnc; VsAun: if (!($result !== true)) { goto RRJLa; } goto tFlXy; xv119: zh1Ky: goto h34CV; PbJMp: $ele = Db::name("\163\x65\164\164\x69\x6e\x67")->where(array("\x6b\x65\x79" => "\x65\x6c\145\155\145\137\163\x77\151\164\x63\150", "\x75\x6e\x69\x61\143\x69\x64" => $GLOBALS["\x75\156\x69\141\143\x69\x64"]))->field("\x76\x61\x6c\165\145")->find(); goto oAgKB; S75Hi: if (empty($ele["\166\x61\154\x75\x65"])) { goto zh1Ky; } goto JxuX9; h34CV: $ele = new \Elemeapi($business, $sandbox); goto lmc9r; JxuX9: $sandbox = "\157\x70\145\x6e"; goto xv119; tFlXy: return isset($result[1]) ? $result[1] : "\351\245\xbf\xe4\xba\x86\xe4\271\x88\xe8\256\xa2\345\x8d\x95\347\x8a\xb6\346\x80\201\346\233\264\xe6\226\260\345\274\202\345\270\xb8\xef\274\x81"; goto u8H5H; VCVnc: return true; goto ZMcdi; ZMcdi: } goto K2Zgz; cfGRw: if (!function_exists("\x62\x75\x69\154\144\x5f\x72\x61\144\x69\x6f\x73")) { function build_radios($name, $list = array(), $selected = null) { goto A_uQ_; wDeyS: $selected = is_array($selected) ? $selected : explode("\x2c", $selected); goto ngvMG; mhKRd: pa7VK: goto SHN8v; A_uQ_: $html = []; goto tofjU; ngvMG: foreach ($list as $k => $v) { $html[] = sprintf(Form::label("{$name}\55{$k}", "\45\x73\40{$v}"), Form::radio($name, $k, in_array($k, $selected), ["\x69\144" => "{$name}\55{$k}"])); zgqtG: } goto mhKRd; SHN8v: return "\x3c\x64\x69\166\40\143\154\141\x73\163\x3d\42\162\141\x64\x69\x6f\42\x3e" . implode("\40", $html) . "\74\x2f\144\151\166\x3e"; goto Sr97Y; tofjU: $selected = is_null($selected) ? key($list) : $selected; goto wDeyS; Sr97Y: } } goto y43JQ; X1hTT: function setXMLData($data) { goto E2qER; mZq61: return ''; goto RO8xk; R1jmr: foreach ($data as $k => $v) { $result .= "\x3c" . $k . "\x3e\74\x21\133\x43\104\101\x54\x41\x5b" . $v . "\135\x5d\76\x3c\x2f" . $k . "\x3e"; JwDBI: } goto RxPzt; E2qER: if (is_array($data)) { goto i5p9F; } goto mZq61; RO8xk: i5p9F: goto qlnwd; jvken: return $result; goto rjvIV; YwBZi: $result .= "\x3c\57\170\x6d\154\x3e"; goto jvken; RxPzt: Sul0d: goto YwBZi; qlnwd: $result = "\x3c\x78\155\154\76"; goto R1jmr; rjvIV: } goto Gmqmf; fqAuj: if (!function_exists("\x62\x75\x69\154\144\x5f\150\145\141\x64\151\156\147")) { function build_heading($path = NULL, $container = TRUE) { goto Ql0wn; hfYWY: if (!$container) { goto TkkbF; } goto ik3qF; RXPRZ: if ($content) { goto UMRNO; } goto vkT1k; FzTmQ: $action = request()->action(); goto a5mn8; TY8yO: $title = __($data["\x74\x69\x74\154\145"]); goto TZjqU; MI6Pf: TkkbF: goto ADSbc; fcUc6: C2Gu2: goto Z5KKm; xBIbY: if (!is_null($path)) { goto C2Gu2; } goto FzTmQ; a5mn8: $controller = str_replace("\56", "\x2f", request()->controller()); goto Q902O; Ql0wn: $title = $content = ''; goto xBIbY; TZjqU: $content = __($data["\x72\145\x6d\141\162\153"]); goto koA33; ik3qF: $result = "\x3c\144\151\x76\40\x63\154\x61\163\x73\x3d\42\160\x61\156\x65\x6c\55\150\x65\141\x64\x69\156\x67\42\x3e" . $result . "\x3c\57\x64\151\166\76"; goto MI6Pf; dpN_c: if (!$data) { goto plVLm; } goto TY8yO; Q902O: $path = strtolower($controller . ($action && $action != "\x69\156\x64\145\170" ? "\x2f" . $action : '')); goto fcUc6; NB5L0: UMRNO: goto ky8kO; Z5KKm: $data = Db::name("\x61\165\164\150\137\162\165\x6c\145")->where("\156\141\x6d\145", $path)->field("\164\x69\164\x6c\145\x2c\162\x65\x6d\141\162\153")->find(); goto dpN_c; ADSbc: return $result; goto cX1vM; vkT1k: return ''; goto NB5L0; koA33: plVLm: goto RXPRZ; ky8kO: $result = "\x3c\x64\151\166\40\x63\x6c\141\x73\x73\75\42\160\x61\156\145\154\x2d\154\145\141\x64\x22\76\x3c\145\155\76" . $title . "\74\x2f\145\x6d\x3e" . $content . "\x3c\57\x64\x69\166\x3e"; goto hfYWY; cX1vM: } } goto iLF1s; fkZ7f: function getCertKey($certPath, $keyPath, $is_user = false) { goto fhiGt; fhiGt: global $_W; goto KKA5M; G9cHD: if (!(empty($mcd["\167\145\143\x68\141\164\x5f\162\x65\x66\x75\156\x64"]["\143\145\x72\x74"]) || empty($mcd["\167\x65\143\150\x61\164\137\x72\x65\146\x75\156\x64"]["\153\145\171"]))) { goto ltr21; } goto oc1GH; C8uPv: ltr21: goto DQPtf; IZBSl: pDLGl: goto dSvrG; RdGVJ: $runiacid["\x76\x61\154\x75\x65"] = $GLOBALS["\x75\156\x69\141\x63\151\x64"]; goto qwrAb; gayNq: I1fQE: goto vOtRC; vOtRC: return array(1, "\xe8\xaf\x81\xe4\xb9\xa6\xe8\xaf\xbb\xe5\217\x96\xe5\244\xb1\xe8\xb4\245\xef\274\x81"); goto rJTBI; pVaxV: return array(0, "\141\160\x70\151\144" => $wxapp["\x6b\x65\171"], "\x6d\143\150\151\144" => $mcd["\x77\145\143\x68\x61\164"]["\155\143\x68\x69\x64"], "\163\x69\147\156\x6b\x65\x79" => $mcd["\167\x65\143\150\x61\x74"]["\x73\x69\x67\156\153\x65\171"]); goto gayNq; qwrAb: kyI7y: goto XhW2S; KKA5M: $runiacid = Db::name("\x73\145\164\164\151\x6e\147")->where(array("\x6b\145\171" => "\162\151\x64\145\x72\x5f\x75\x6e\151\x61\143\x69\x64", "\165\156\x69\x61\x63\x69\144" => $GLOBALS["\165\156\x69\x61\143\x69\x64"]))->find(); goto bK6yA; RtIup: return array(1, "\346\x9c\252\xe6\211\xbe\xe5\210\260\xe5\xb0\217\347\250\213\xe5\xba\217\xef\xbc\x81"); goto IZBSl; A03B7: !empty($res[0]) && !empty($res[0]) && ($mcd = unserialize($res[0])); goto lUx4_; Gj3qf: SP0mj: goto G9cHD; dSvrG: if (!(!empty($certPath) && !empty($keyPath))) { goto I1fQE; } goto t_WjM; XmcUa: if (!(empty($wxapp) || empty($wxapp["\153\145\171"]))) { goto pDLGl; } goto RtIup; oc1GH: return array(1, "\xe6\234\252\xe9\x85\215\347\275\256\351\200\x80\346\xac\xbe\350\xaf\x81\xe4\xb9\xa6\357\274\x81"); goto C8uPv; i_rFW: $mcd = array(); goto A03B7; MdZoQ: return array(1, "\xe6\x9c\xaa\351\x85\x8d\xe7\275\256\xe5\276\xae\344\277\xa1\346\x94\xaf\344\xbb\x98\xef\xbc\201"); goto Gj3qf; kngOf: return array(1, "\346\234\252\344\xb8\216\xe9\xaa\221\346\211\213\xe7\253\xaf\xe5\260\x8f\347\xa8\213\345\272\x8f\347\xbb\221\xe5\xae\x9a\xef\xbc\x81"); goto Tc4wU; v2aR7: if (!$is_user) { goto kyI7y; } goto RdGVJ; TaWML: file_put_contents($keyPath, authcode($mcd["\167\x65\143\150\x61\164\137\162\145\146\x75\156\x64"]["\x6b\x65\x79"], "\x44\105\x43\117\104\105")); goto pVaxV; bK6yA: if (!(empty($runiacid) || empty($runiacid["\x76\141\154\x75\x65"]))) { goto Aa4vm; } goto kngOf; t_WjM: file_put_contents($certPath, authcode($mcd["\x77\145\x63\x68\x61\x74\x5f\162\x65\146\165\156\x64"]["\x63\145\x72\164"], "\x44\x45\x43\x4f\104\x45")); goto TaWML; DQPtf: $wxapp = Db::table($_W["\x63\157\x6e\x66\x69\x67"]["\144\142"]["\x74\141\142\x6c\145\160\162\145"] . "\141\x63\143\x6f\x75\x6e\x74\137\167\x78\x61\x70\160")->where(array("\x75\x6e\x69\x61\143\x69\x64" => $runiacid["\x76\x61\154\165\145"]))->find(); goto XmcUa; XhW2S: $res = Db::table($_W["\x63\157\156\x66\x69\147"]["\x64\142"]["\164\141\142\x6c\x65\x70\162\x65"] . "\x75\x6e\x69\x5f\x73\145\164\x74\x69\x6e\147\163")->where("\x75\x6e\151\x61\143\151\x64", $runiacid["\x76\x61\154\x75\145"])->column("\x70\141\171\155\x65\x6e\164"); goto i_rFW; lUx4_: if (!(empty($mcd) || empty($mcd["\x77\x65\x63\150\141\164"]["\155\x63\150\151\144"]) || empty($mcd["\167\x65\x63\150\x61\164"]["\x73\151\147\156\x6b\145\x79"]))) { goto SP0mj; } goto MdZoQ; Tc4wU: Aa4vm: goto v2aR7; rJTBI: } goto gP06s; K2Zgz: function update_eleme_location($order_code, $business, $lat = 0, $lng = 0) { goto I6zkh; I6zkh: vendor("\x65\x6c\x65\x6d\145\x2e\x45\x6c\x65\155\145\141\160\x69"); goto UGvwi; hXaJ1: $param = array("\x73\x68\x6f\160\111\144" => $business["\163\150\x6f\x70\x5f\151\144"], "\157\x72\x64\x65\x72\111\144" => str_replace("\x42", '', $order_code), "\154\157\143\141\164\151\157\x6e\111\156\146\x6f" => array("\x6c\141\164\151\164\165\144\145" => $lat, "\x6c\157\156\147\x69\164\165\x64\x65" => $lng, "\141\154\164\x69\164\165\x64\x65" => 120.2, "\165\x74\143" => time())); goto UA7Js; UA7Js: $result = $ele->call("\x65\x6c\x65\155\x65\56\x6f\162\x64\x65\x72\56\x73\145\x6c\x66\x44\x65\154\x69\166\x65\x72\171\114\x6f\x63\141\164\151\x6f\x6e\x53\x79\156\x63", $param); goto TYgt5; kak1C: ive1C: goto kOJOt; UGvwi: $ele = new \Elemeapi($business); goto hXaJ1; TYgt5: if (!($result !== true)) { goto ive1C; } goto Q8mCU; Q8mCU: return false; goto kak1C; kOJOt: return true; goto Mh3yy; Mh3yy: } goto yS3nO; k72af: if (!function_exists("\142\165\x69\x6c\x64\137\164\x6f\157\x6c\142\x61\x72")) { function build_toolbar($btns = NULL, $attr = array()) { goto lM5JQ; N8DJd: $index = array_search("\144\145\x6c\x65\x74\145", $btns); goto VCX9f; Yne0x: $btns[$index] = "\144\x65\154"; goto HwDNy; wClF0: return implode("\40", $html); goto dva7W; VCX9f: if (!($index !== FALSE)) { goto aXJtw; } goto Yne0x; Q91Of: foreach ($btns as $k => $v) { goto Sfugb; Ki4GL: $html[] = "\74\x61\40\150\x72\145\146\75\42" . $href . "\x22\x20\x63\154\141\x73\163\x3d\x22" . $class . "\42\40\164\151\x74\154\145\75\x22" . $title . "\42\40" . $extend . "\x3e\74\x69\40\x63\x6c\x61\x73\x73\x3d\42" . $icon . "\x22\x3e\x3c\x2f\151\76\40" . $text . "\x3c\57\141\x3e"; goto Noe6z; pzkwr: DQIFt: goto a0H2Q; Sfugb: if (!(!isset($btnAttr[$v]) || $v !== "\x72\x65\146\162\145\163\x68" && !$auth->check("{$controller}\x2f{$v}"))) { goto DQIFt; } goto IHBkS; a0H2Q: list($href, $class, $icon, $text, $title) = $btnAttr[$v]; goto jTnRR; IHBkS: goto Aeq4z; goto pzkwr; Noe6z: Aeq4z: goto qSW46; jTnRR: $extend = $v == "\151\155\x70\157\162\x74" ? "\x69\x64\75\42\142\x74\156\55\x69\155\x70\157\162\164\x2d\146\x69\x6c\x65\42\x20\x64\x61\164\141\x2d\x75\x72\x6c\x3d\x22\x61\152\x61\x78\x2f\165\160\154\157\141\x64\42\x20\144\x61\x74\x61\x2d\155\151\155\145\164\x79\160\x65\x3d\x22\x63\163\166\x2c\x78\154\x73\x2c\x78\154\163\x78\x22\x20\144\x61\164\141\x2d\155\x75\154\x74\151\x70\154\x65\75\x22\146\141\x6c\x73\x65\x22" : ''; goto Ki4GL; qSW46: } goto Nr7UD; Nr7UD: VV_V5: goto wClF0; HwDNy: aXJtw: goto ZRQnh; CLR7a: $controller = str_replace("\x2e", "\x2f", strtolower(think\Request::instance()->controller())); goto Goda_; Xd9ZN: $html = []; goto Q91Of; GHO0m: $btns = is_array($btns) ? $btns : explode("\54", $btns); goto N8DJd; ZRQnh: $btnAttr = ["\x72\145\x66\x72\x65\163\x68" => ["\152\x61\166\141\x73\143\x72\151\x70\164\72\x3b", "\142\x74\156\40\x62\164\156\x2d\x70\x72\151\x6d\x61\x72\171\40\142\x74\x6e\x2d\x72\145\x66\162\145\163\x68", "\x66\141\40\x66\141\55\x72\145\x66\162\145\x73\150", '', __("\x52\x65\146\x72\145\163\150")], "\x61\144\x64" => ["\x6a\141\166\x61\x73\143\162\151\160\164\x3a\73", "\x62\164\156\x20\x62\164\x6e\x2d\163\165\x63\x63\145\x73\163\40\142\164\x6e\x2d\141\144\144", "\x66\x61\x20\x66\141\x2d\160\x6c\165\163", __("\x41\x64\x64"), __("\x41\x64\x64")], "\x65\144\x69\x74" => ["\152\141\x76\x61\x73\143\x72\x69\x70\164\72\73", "\142\164\x6e\x20\x62\x74\156\x2d\163\x75\143\143\145\x73\x73\40\142\x74\156\x2d\x65\144\151\164\40\142\x74\156\55\x64\x69\x73\x61\x62\x6c\145\x64\40\144\151\x73\x61\142\154\x65\x64", "\x66\141\x20\x66\141\55\160\145\x6e\x63\x69\x6c", __("\x45\144\151\164"), __("\105\144\x69\164")], "\144\145\154" => ["\x6a\x61\x76\x61\x73\x63\x72\151\x70\x74\72\73", "\x62\x74\156\x20\142\x74\x6e\x2d\144\141\156\147\x65\162\40\x62\164\x6e\x2d\144\145\x6c\x20\x62\x74\156\55\144\x69\163\x61\142\154\x65\144\40\144\151\x73\141\x62\x6c\145\144", "\146\141\x20\146\141\55\164\x72\x61\x73\x68", __("\104\x65\x6c\x65\x74\x65"), __("\x44\145\154\x65\164\145")], "\151\x6d\x70\x6f\x72\x74" => ["\152\141\x76\x61\x73\143\162\x69\160\164\72\73", "\142\164\156\x20\142\x74\156\x2d\x64\141\156\x67\145\162\x20\142\164\x6e\55\x69\x6d\160\x6f\162\x74", "\146\x61\x20\x66\141\x2d\165\160\x6c\157\x61\x64", __("\x49\x6d\160\157\162\x74"), __("\111\x6d\160\157\162\164")]]; goto ASV9g; lM5JQ: $auth = \app\admin\library\Auth::instance(); goto CLR7a; ASV9g: $btnAttr = array_merge($btnAttr, $attr); goto Xd9ZN; Goda_: $btns = $btns ? $btns : ["\x72\x65\x66\x72\x65\163\x68", "\x61\144\x64", "\x65\x64\151\164", "\x64\x65\x6c", "\151\155\160\157\x72\x74"]; goto GHO0m; dva7W: } } goto fqAuj; lU5u1: if (!function_exists("\142\x75\151\x6c\x64\137\163\x65\x6c\145\143\164")) { function build_select($name, $options, $selected = array(), $attr = array()) { goto F3qfy; F3qfy: $options = is_array($options) ? $options : explode("\x2c", $options); goto XeHtE; S8FWS: return Form::select($name, $options, $selected, $attr); goto sd96C; XeHtE: $selected = is_array($selected) ? $selected : explode("\54", $selected); goto S8FWS; sd96C: } } goto cfGRw; kwV4E: if (!function_exists("\162\141\x6e\144\x6f\155")) { function random($length, $numeric = FALSE) { goto ouDdo; sZWK5: $max = strlen($seed) - 1; goto T34co; rcs9b: lVkfK: goto vXvC5; T34co: $i = 0; goto F87AU; nBpK9: $hash .= $seed[mt_rand(0, $max)]; goto meTd_; meTd_: tkjTy: goto xQG1j; BzRHG: goto s72Kh; goto bkBoY; rZf4a: $hash = chr(rand(1, 26) + rand(0, 1) * 32 + 64); goto x0cm7; x0cm7: $length--; goto BzRHG; h9WVi: $seed = $numeric ? str_replace("\60", '', $seed) . "\60\61\x32\x33\x34\60\x35\66\67\x38\x39\x30" : $seed . "\x7a\x5a" . strtoupper($seed); goto oy5ER; EJfIL: if (!($i < $length)) { goto lVkfK; } goto nBpK9; ouDdo: $seed = base_convert(md5(microtime() . $_SERVER["\x44\117\103\125\x4d\x45\x4e\x54\137\x52\x4f\x4f\124"]), 16, $numeric ? 10 : 35); goto h9WVi; vXvC5: return $hash; goto vwteq; MAoLM: s72Kh: goto sZWK5; F87AU: KfzKy: goto EJfIL; bkBoY: t3oip: goto tXrYZ; xQG1j: $i++; goto n9Ckd; oy5ER: if ($numeric) { goto t3oip; } goto rZf4a; tXrYZ: $hash = ''; goto MAoLM; n9Ckd: goto KfzKy; goto rcs9b; vwteq: } } goto LXHmC; Hk2Ew: if (!function_exists("\x67\x65\156\145\x72\141\164\145\x5f\x72\141\156\144\157\x6d\137\163\164\162")) { function generate_random_str($length = 12, $type = "\155\x69\x78\x65\x64") { goto sHVLz; Jbwdx: $i++; goto Hj3No; sRZGR: HXCVc: goto Jbwdx; bN4og: $strlen = strlen($chars); goto A53p4; ac2W7: $type = strtolower($type); goto kBxwK; BpVaz: $str .= substr($chars, rand(0, $strlen - 1), 1); goto sRZGR; IEvwO: return $str; goto bZjtP; kBxwK: switch ($type) { case "\x6c\157\x77\x65\x72": $chars = $lower; goto E9tWE; case "\x75\160\x70\x65\x72": $chars = $upper; goto E9tWE; case "\154\x65\x74\x74\x65\x72": $chars = $lower . $upper; goto E9tWE; case "\x6e\165\x6d\145\x72\x69\x63": $chars = $numeric; goto E9tWE; default: $chars = $lower . $upper . $numeric . $special; } goto z0MsG; sHVLz: $lower = "\141\x62\x63\144\145\x66\x67\x68\x69\152\x6b\154\155\x6e\x6f\x70\161\162\x73\164\165\166\167\170\x79\x7a"; goto GKwXn; Hj3No: goto MYK6s; goto xK0vV; fNUvT: if (!($i < $length)) { goto Ozd77; } goto BpVaz; A53p4: $i = 0; goto XUOsw; xK0vV: Ozd77: goto IEvwO; GKwXn: $upper = "\101\x42\103\104\x45\x46\x47\x48\111\x4a\x4b\x4c\x4d\116\x4f\120\x51\x52\x53\124\125\x56\x57\x58\131\132"; goto UPy6i; UPy6i: $numeric = "\x30\x31\x32\63\64\x35\66\x37\x38\x39"; goto qm2Ln; jgt9u: $str = ''; goto bN4og; ut1_g: E9tWE: goto jgt9u; XUOsw: MYK6s: goto fNUvT; z0MsG: EPBJa: goto ut1_g; qm2Ln: $special = "\41\x40\43\x24\45\136\46\52\50\51\55\137\x20\133\135\x7b\x7d\x3c\76\176\x60\53\x3d\54\x2e\73\x3a\x2f\77\x7c"; goto ac2W7; bZjtP: } } goto Pnb8I; Dyy0O: function send_aliyun_sms($mobile, $codeParam, $templateCode = "\x61\x6c\x69\137\164\145\x6d\160\x5f\143\x6f\x64\145") { goto sx9Zr; NNe0z: if (!(!empty($params["\x54\145\155\160\x6c\x61\164\145\x50\141\x72\x61\155"]) && is_array($params["\x54\x65\x6d\160\154\141\x74\145\120\x61\x72\x61\x6d"]))) { goto w9B2U; } goto rcWaC; drZ_I: return !empty($result) ? json_decode($result, true) : array(); goto aZzuc; il0Kj: aS2nu: goto PwSiI; JPRQa: w9B2U: goto oiscv; rcWaC: $params["\x54\x65\x6d\x70\154\141\164\x65\x50\141\162\141\155"] = json_encode($params["\124\145\155\x70\x6c\x61\164\x65\x50\x61\x72\x61\155"], JSON_UNESCAPED_UNICODE); goto JPRQa; pQuhZ: $params["\123\151\147\x6e\x4e\x61\x6d\x65"] = !empty($smsparam["\x61\154\151\x5f\163\x69\x67\x6e\137\156\x61\x6d\145"]) ? $smsparam["\141\154\x69\x5f\x73\151\x67\x6e\x5f\156\x61\x6d\x65"] : ''; goto B3z61; sx9Zr: if (!empty($mobile)) { goto aS2nu; } goto sDBQ1; KDp1O: $params["\x50\150\157\x6e\x65\116\165\155\x62\x65\162\x73"] = $mobile; goto cmF1q; oiscv: vendor("\101\154\x69\x79\165\156\56\x53\x69\x67\156\x61\164\x75\162\x65\110\145\154\x70\x65\162"); goto fUzCx; fUzCx: $helper = new \SignatureHelper(); goto OPjxV; sDBQ1: return false; goto il0Kj; tthrX: $where = array("\165\156\151\x61\143\x69\144" => $GLOBALS["\165\x6e\x69\141\143\x69\144"]); goto YMlis; ajkE6: $keyId = !empty($smsparam["\141\154\x69\137\163\155\163\137\141\160\160\151\144"]) ? $smsparam["\x61\154\x69\x5f\x73\x6d\163\x5f\x61\x70\x70\151\x64"] : ''; goto l72Nj; PwSiI: $params = array(); goto tthrX; YMlis: $smsparam = Db::name("\x73\x65\164\x74\x69\156\147")->where($where)->where("\153\x65\x79", "\151\x6e", "\141\x6c\x69\137\163\155\163\137\141\160\x70\x69\x64\x2c\x61\x6c\151\x5f\x73\x6d\163\137\163\145\x63\162\x65\164\54\141\154\151\137\x73\x69\147\156\x5f\156\141\155\x65\54" . $templateCode)->column("\x6b\x65\x79\54\x76\x61\x6c\x75\x65"); goto ajkE6; cmF1q: $params["\x54\x65\155\x70\x6c\x61\x74\145\x50\x61\x72\141\155"] = $codeParam; goto NNe0z; l72Nj: $keySecret = !empty($smsparam["\141\154\151\x5f\x73\x6d\x73\x5f\163\x65\x63\162\145\164"]) ? $smsparam["\x61\x6c\151\137\163\x6d\x73\x5f\x73\x65\143\x72\x65\164"] : ''; goto pQuhZ; B3z61: $params["\124\145\x6d\x70\x6c\141\164\x65\x43\x6f\144\x65"] = !empty($smsparam[$templateCode]) ? $smsparam[$templateCode] : ''; goto KDp1O; OPjxV: $result = $helper->request($keyId, $keySecret, $params); goto drZ_I; aZzuc: } goto Kojdk; Pnb8I: function generateDataSign($data, $type = "\155\144\65", $signkey = '') { goto KQ_Im; uCn3h: $sign = implode("\x26", $sign); goto Lnn9w; KQ_Im: $sign = array(); goto dekp3; JOauU: return $sign; goto SIBHe; Lnn9w: $sign = $type == "\115\104\65" ? md5($sign) : hash_hmac("\163\x68\141\x32\x35\66", $sign, $signkey); goto HGTG5; dekp3: $type = strtoupper($type); goto oyL_X; cOx5a: foreach ($data as $k => $v) { goto NrpCp; qTXud: $sign[] = $k . "\x3d" . $v; goto H7tJF; NrpCp: if (!($v === '' || $v === false || $v === null)) { goto H4OqE; } goto QDu6m; QDu6m: goto aYHCQ; goto Mu9Vo; Mu9Vo: H4OqE: goto qTXud; H7tJF: aYHCQ: goto HZXYA; HZXYA: } goto LGqb0; oyL_X: ksort($data); goto cOx5a; HGTG5: $sign = strtoupper($sign); goto JOauU; LGqb0: q578s: goto RToYw; RToYw: $sign[] = "\x6b\x65\x79\75" . $signkey; goto uCn3h; SIBHe: } goto xW4fC; xW4fC: function setRequest($url, $post = false, $ssl = true, $certPath = '', $keyPath = '') { goto Vo9RT; S0DkA: if (!is_file($keyPath)) { goto d4Qzf; } goto muxRf; p7eXb: qq2SO: goto S0DkA; fp7pV: $result = curl_exec($ch); goto SjJkr; m1O_9: return $result; goto DarHj; VF8v1: curl_setopt($ch, CURLOPT_POSTFIELDS, $post); goto Lbj2U; l2wuJ: curl_setopt($ch, CURLOPT_SSLCERT, $certPath); goto p7eXb; Lbj2U: mPLmU: goto z75Px; Sq_nR: curl_setopt($ch, CURLOPT_HEADER, false); goto angDc; AYs5Q: if (!is_file($certPath)) { goto qq2SO; } goto l2wuJ; EFkXD: curl_setopt($ch, CURLOPT_POST, true); goto VF8v1; z75Px: if (!($ssl && $post)) { goto gRIaL; } goto AYs5Q; pJN2d: if (!(ini_get("\157\160\x65\156\x5f\x62\x61\x73\145\144\151\162") == '' && strtolower(ini_get("\163\x61\x66\x65\137\155\157\x64\x65")) != "\x6f\156")) { goto jcxtA; } goto dDq1Z; a1Ntk: d4Qzf: goto WzbZ6; dDq1Z: curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true); goto x2L8T; x2L8T: jcxtA: goto AG2ek; VyCoS: curl_setopt($ch, CURLOPT_URL, $url); goto Sq_nR; Vo9RT: $result = ''; goto R3CTl; WzbZ6: gRIaL: goto fp7pV; bhIni: curl_setopt($ch, CURLOPT_MAXREDIRS, 5); goto pJN2d; Y3Ptw: curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5); goto qcLHI; R3CTl: if (!function_exists("\x63\x75\x72\x6c\137\151\156\x69\x74")) { return ''; } goto YWUip; YWUip: $ch = curl_init(); goto VyCoS; qcLHI: if (!$post) { goto mPLmU; } goto EFkXD; angDc: curl_setopt($ch, CURLOPT_TIMEOUT, 30); goto bhIni; SjJkr: curl_close($ch); goto m1O_9; AG2ek: curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); goto Y3Ptw; muxRf: curl_setopt($ch, CURLOPT_SSLKEY, $keyPath); goto a1Ntk; DarHj: } goto X1hTT; yS3nO: function httpPost($url, $param = array(), $header = array()) { goto B7Q6C; ElgLQ: return $result; goto PqpoW; KAkXf: dtJXw: goto hYLV9; iYF2F: curl_setopt($ch, CURLOPT_POST, 1); goto BZhkn; ivymY: curl_setopt($ch, CURLOPT_HTTPHEADER, $header); goto DwB53; AkjJ4: throw new Exception("\103\165\162\154\40\105\x72\x72\157\162\x28" . $errno . "\51\x3a" . curl_error($ch)); goto KAkXf; hYLV9: curl_close($ch); goto ElgLQ; B7Q6C: $ch = curl_init(); goto E8ZAh; b_a2T: curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false); goto ivymY; qZqTg: curl_setopt($ch, CURLOPT_HEADER, 0); goto PjVgC; PjVgC: curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); goto iYF2F; BZhkn: curl_setopt($ch, CURLOPT_POSTFIELDS, $param); goto SVkpp; E8ZAh: curl_setopt($ch, CURLOPT_URL, $url); goto qZqTg; DwB53: $result = curl_exec($ch); goto klLXW; klLXW: if (!($errno = curl_errno($ch))) { goto dtJXw; } goto AkjJ4; SVkpp: curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); goto b_a2T; PqpoW: } goto a2aGm; gP06s: function addRiderMessage($rider_id, $type, $title, $content = '', $object_id = 0, $is_all = 0) { goto YSDJK; RllRX: $add = Db::name("\x72\x69\144\145\x72\137\155\x65\x73\163\141\x67\145")->insert($data); goto pJEk3; hX_AS: return false; goto Rodc6; YSDJK: $data = array("\x72\x69\144\145\x72\x5f\151\144" => intval($rider_id), "\x74\171\x70\145" => intval($type), "\x74\151\x74\x6c\x65" => trim($title), "\143\157\x6e\164\x65\x6e\x74" => $content, "\x6f\x62\152\145\143\x74\137\151\x64" => intval($object_id), "\141\x6c\x6c" => intval($is_all), "\141\144\x64\137\x74\151\155\x65" => time(), "\x75\x6e\x69\141\x63\x69\x64" => $GLOBALS["\x75\x6e\151\x61\143\x69\144"]); goto RllRX; oQ_kG: FyOPI: goto hX_AS; DhbeI: return true; goto oQ_kG; pJEk3: if (empty($add)) { goto FyOPI; } goto DhbeI; Rodc6: } goto W3haT; a2aGm: function createPoster($config = array(), $filename = '') { goto iYYot; jm_D6: W9dhq: goto Z0Vxb; gpmZS: $color = imagecolorallocate($imageRes, 0, 0, 0); goto KPnWV; tUBnO: if (empty($config["\x69\x6d\x61\x67\145"])) { goto AJ0_8; } goto CRVUw; d8p_0: $backgroundWidth = imagesx($background); goto ZpzD_; oRRuM: imagejpeg($imageRes); goto vd4jc; UUBIf: if ($res) { goto W9dhq; } goto eupLC; GOCb8: imagedestroy($imageRes); goto UUBIf; viXJU: $backgroundFun = "\151\x6d\x61\x67\x65\143\162\145\x61\164\x65\146\x72\157\x6d" . image_type_to_extension($backgroundInfo[2], false); goto o18Ej; CRVUw: foreach ($config["\x69\155\x61\147\x65"] as $key => $val) { goto b8GzT; C05RI: $canvas = imagecreatetruecolor($val["\167\x69\x64\x74\150"], $val["\150\x65\151\x67\x68\x74"]); goto XlXkJ; MugN5: $resHeight = $info[1]; goto C05RI; I3tkV: $function = "\x69\x6d\x61\x67\145\143\x72\145\141\x74\x65\146\x72\x6f\x6d" . image_type_to_extension($info[2], false); goto XbX8h; gnGWi: $resWidth = $info[0]; goto MugN5; K6EIE: mzloK: goto wJ26O; gJokB: $res = roundImg($val["\x75\x72\x6c"]); goto gnGWi; L7IYS: $val["\164\157\160"] = $val["\x74\x6f\160"] < 0 ? $backgroundHeight - abs($val["\164\x6f\160"]) - $val["\150\145\x69\147\x68\x74"] : $val["\x74\157\160"]; goto xHkdB; xHkdB: imagecopymerge($imageRes, $canvas, $val["\x6c\145\146\164"], $val["\164\x6f\x70"], $val["\162\x69\x67\150\x74"], $val["\x62\x6f\164\164\157\x6d"], $val["\x77\x69\144\x74\150"], $val["\150\145\x69\147\150\x74"], $val["\x6f\x70\x61\143\151\x74\171"]); goto K6EIE; zH7_1: $function = "\151\x6d\141\x67\x65\x63\x72\145\141\164\x65\146\162\x6f\x6d\163\x74\162\x69\x6e\x67"; goto YAqC4; NRBhm: imagecolortransparent($canvas, $color); goto wcfC6; dr1nH: $val["\154\145\x66\164"] = $val["\154\145\x66\x74"] < 0 ? $backgroundWidth - abs($val["\x6c\145\146\164"]) - $val["\x77\x69\144\164\150"] : $val["\154\x65\x66\x74"]; goto L7IYS; duRo1: imagecopyresampled($canvas, $res, 0, 0, 0, 0, $val["\167\x69\x64\x74\x68"], $val["\150\145\x69\x67\x68\164"], $resWidth, $resHeight); goto dr1nH; ZBQ5x: $info = getimagesizefromstring($val["\x75\x72\x6c"]); goto zH7_1; YAqC4: uTTzZ: goto gJokB; wcfC6: imagefill($canvas, 0, 0, $color); goto duRo1; XlXkJ: $color = imagecolorallocate($canvas, 255, 250, 250); goto NRBhm; fPsw3: $info = getimagesize($val["\165\162\x6c"]); goto I3tkV; XbX8h: if (!$val["\x73\164\162\145\x61\x6d"]) { goto uTTzZ; } goto ZBQ5x; b8GzT: $val = array_merge($imageDefault, $val); goto fPsw3; wJ26O: } goto Z0Cml; I60MT: $backgroundInfo = getimagesize($background); goto viXJU; R1c_N: Jk2IZ: goto kFhKj; wnrwn: imagecopyresampled($imageRes, $background, 0, 0, 0, 0, imagesx($background), imagesy($background), imagesx($background), imagesy($background)); goto tUBnO; kFhKj: if (!empty($filename)) { goto oI5iF; } goto oRRuM; y83G3: foreach ($config["\164\145\170\164"] as $key => $val) { goto K6DEM; zqFXo: list($R, $G, $B) = explode("\54", $val["\146\157\156\164\x43\157\x6c\x6f\162"]); goto mblTQ; dyPbH: $val["\x6c\x65\146\164"] = $val["\154\x65\146\x74"] < 0 ? $backgroundWidth - abs($val["\x6c\x65\146\x74"]) : $val["\x6c\x65\146\x74"]; goto q18TI; K6DEM: $val = array_merge($textDefault, $val); goto zqFXo; clNhx: imagettftext($imageRes, $val["\x66\157\156\x74\x53\151\x7a\x65"], $val["\141\156\x67\154\145"], $val["\x6c\145\x66\164"], $val["\164\157\160"], $fontColor, $val["\x66\x6f\156\x74\x50\141\164\150"], $val["\164\145\170\164"]); goto Vk0zD; mblTQ: $fontColor = imagecolorallocate($imageRes, $R, $G, $B); goto dyPbH; q18TI: $val["\x74\157\x70"] = $val["\164\x6f\x70"] < 0 ? $backgroundHeight - abs($val["\x74\x6f\x70"]) : $val["\x74\x6f\160"]; goto clNhx; Vk0zD: Lz3nk: goto cgG7c; cgG7c: } goto UkK5Q; eupLC: return false; goto jm_D6; o18Ej: $background = $backgroundFun($background); goto d8p_0; KPnWV: imagefill($imageRes, 0, 0, $color); goto WFC9L; ZpzD_: $backgroundHeight = imagesy($background); goto QeI6h; QeI6h: $imageRes = imageCreatetruecolor($backgroundWidth, $backgroundHeight); goto gpmZS; WFC9L: imageColorTransparent($imageRes, $color); goto wnrwn; UkK5Q: uXgZw: goto R1c_N; FfhQn: $background = $config["\x62\141\143\153\147\x72\157\165\x6e\144"]; goto I60MT; ltfbS: AJ0_8: goto Y29Ha; iYYot: $imageDefault = array("\154\145\x66\x74" => 0, "\164\157\160" => 0, "\162\151\x67\x68\164" => 0, "\x62\x6f\x74\164\x6f\x6d" => 0, "\167\151\144\164\150" => 100, "\150\x65\151\147\x68\164" => 100, "\x6f\x70\x61\143\151\x74\x79" => 100); goto EQFUx; f0fdS: $res = imagejpeg($imageRes, $filename, 90); goto GOCb8; ducTr: oI5iF: goto f0fdS; vd4jc: imagedestroy($imageRes); goto o1g1a; o1g1a: goto rYiFr; goto ducTr; jDC1P: rYiFr: goto HoAO9; Y29Ha: if (empty($config["\x74\x65\170\164"])) { goto Jk2IZ; } goto y83G3; Z0Vxb: return $filename; goto jDC1P; EQFUx: $textDefault = array("\164\x65\170\164" => '', "\154\145\146\x74" => 0, "\x74\x6f\x70" => 0, "\x66\157\156\x74\123\151\172\145" => 32, "\x66\157\156\x74\103\157\x6c\x6f\x72" => "\62\65\x35\54\62\65\65\54\62\x35\x35", "\141\x6e\147\x6c\145" => 0); goto FfhQn; Z0Cml: NXsYN: goto ltfbS; HoAO9: } goto gyLz4; W3haT: function getScopeRider($order_id, $type = 0) { goto pGwbh; VqyQf: $distance["\x76\x61\154\165\145"] = !empty($distance["\166\x61\x6c\x75\x65"]) ? intval($distance["\166\x61\x6c\x75\145"]) : 10; goto Xd2df; sTRy7: $distance = Db::name("\x73\x65\164\x74\151\156\x67")->where(array("\x6b\145\x79" => "\x72\151\x64\145\162\137\x64\x69\163\x74\x61\156\x63\x65", "\x75\156\151\141\x63\151\x64" => $GLOBALS["\165\x6e\x69\x61\x63\x69\144"]))->find(); goto VqyQf; qaiwE: $where["\x69\x73\x5f\141\x63\143\x65\x70\x74"] = 1; goto c_kNl; Xd2df: $scope = getPointDistance($address["\x62\145\x67\151\156\x5f\154\x6e\x67"], $address["\x62\x65\147\151\x6e\x5f\x6c\x61\x74"], $distance["\166\x61\x6c\x75\145"] * 2); goto qaiwE; wjiSi: $rider = Db::name("\162\151\x64\145\x72\137\151\x6e\146\x6f")->where($where)->where("\154\141\x74", ["\76\x3d", $scope["\x6d\151\156\x6c\x61\x74"]], ["\x3c\75", $scope["\x6d\x61\170\x6c\x61\164"]], "\x61\156\x64")->where("\x6c\156\x67", ["\x3e\x3d", $scope["\155\151\156\x6c\x6e\147"]], ["\74\x3d", $scope["\x6d\x61\x78\x6c\x6e\x67"]], "\x61\x6e\144")->column("\x72\151\x64\145\x72\x5f\x69\144\54\154\x61\164\x2c\x6c\x6e\x67"); goto xUMYl; xKz3J: return $rider; goto i11C0; xUMYl: if (!empty($rider)) { goto qPu04; } goto yvVJb; pGwbh: $address = Db::name("\157\x72\x64\x65\x72\137\141\144\144\x72\145\163\x73")->where(array("\157\162\144\x65\x72\x5f\151\144" => $order_id))->find(); goto XfMpU; UP4Mw: return array(); goto Ea_zj; Ea_zj: j0br8: goto sTRy7; vAqNs: qPu04: goto xKz3J; XfMpU: if (!empty($address)) { goto j0br8; } goto UP4Mw; c_kNl: $where["\x75\156\151\141\x63\x69\144"] = $GLOBALS["\x75\x6e\x69\141\143\151\x64"]; goto wjiSi; yvVJb: return array(); goto vAqNs; i11C0: } goto xESJ3; y43JQ: if (!function_exists("\142\x75\151\x6c\x64\137\143\150\145\143\x6b\x62\157\x78\163")) { function build_checkboxs($name, $list = array(), $selected = null) { goto CkE8a; Wb1rX: $selected = is_array($selected) ? $selected : explode("\x2c", $selected); goto k2PBr; a0kfI: $selected = is_null($selected) ? [] : $selected; goto Wb1rX; CkE8a: $html = []; goto a0kfI; kGtyI: tRBgG: goto n_xMg; n_xMg: return "\74\x64\x69\166\x20\x63\154\141\x73\x73\x3d\x22\x63\x68\145\x63\153\142\x6f\x78\42\76" . implode("\x20", $html) . "\x3c\x2f\x64\151\166\x3e"; goto OafjU; k2PBr: foreach ($list as $k => $v) { $html[] = sprintf(Form::label("{$name}\x2d{$k}", "\x25\163\x20{$v}"), Form::checkbox($name, $k, in_array($k, $selected), ["\151\x64" => "{$name}\x2d{$k}"])); l0wCR: } goto kGtyI; OafjU: } } goto cevLQ; xESJ3: function get_point_distance($from, $to) { goto eznBg; axWTz: $result = json_decode($result, true); goto SR4vW; eznBg: $setting = Db::name("\x73\x65\x74\164\151\x6e\x67")->where(array("\x75\x6e\151\x61\143\151\x64" => $GLOBALS["\165\x6e\x69\x61\143\x69\x64"], "\x6b\x65\x79" => "\x74\145\x6e\x63\145\x6e\164\137\x6b\x65\171"))->field("\x76\x61\154\165\x65")->find(); goto sowfi; Myol2: $result = setRequest($url); goto axWTz; ALhVE: WSvlK: goto yZHQs; SR4vW: if (!(empty($result) || $result["\163\x74\141\164\x75\163"] !== 0 || empty($result["\162\x65\163\x75\154\164"]["\145\x6c\145\155\145\x6e\x74\163"]))) { goto WSvlK; } goto tBBHy; tBBHy: return array(); goto ALhVE; sowfi: $key = !empty($setting["\166\141\154\165\145"]) ? $setting["\166\x61\x6c\x75\x65"] : "\x59\64\123\x42\132\x2d\130\107\67\66\127\55\x45\115\x4f\122\117\x2d\122\106\112\66\x48\55\x4a\x32\127\x4e\x56\x2d\117\x4e\102\113\123"; goto zoJTD; IU1Ls: $url .= "\46\x66\162\x6f\155\x3d" . $from . "\46\164\157\75" . $to; goto Myol2; yZHQs: return $result["\162\x65\x73\165\x6c\x74"]["\145\154\145\155\145\156\164\163"]; goto ZPVrk; zoJTD: $url = "\x68\x74\x74\x70\163\x3a\x2f\57\141\x70\151\163\x2e\x6d\141\160\56\x71\x71\x2e\x63\157\x6d\57\167\x73\57\144\x69\x73\164\x61\x6e\x63\x65\x2f\x76\61\57\77\x6d\x6f\x64\x65\x3d\167\x61\x6c\x6b\x69\x6e\x67\x26\x6b\x65\x79\x3d" . $key; goto IU1Ls; ZPVrk: } goto Dyy0O; iLF1s: if (!function_exists("\147\x65\164\x50\157\151\156\x74\104\151\x73\164\141\156\143\x65")) { function getPointDistance($lng, $lat, $distance = 1, $radius = 6371) { goto fv8x9; buP66: $maxLng = $lng + $dlng; goto Bt0KS; FI9F5: $dlat = rad2deg($dlat); goto OxQQw; fv8x9: $dlng = 2 * asin(sin($distance / (2 * $radius)) / cos(deg2rad($lat))); goto qFl1a; Bt0KS: return array("\x6d\x69\x6e\x6c\141\x74" => $lat - $dlat, "\x6d\151\x6e\x6c\x6e\147" => $lng - $dlng, "\155\141\x78\x6c\141\164" => $lat + $dlat, "\x6d\x61\170\154\156\147" => $lng + $dlng); goto CuIZl; zcj3J: $dlat = $distance / $radius; goto FI9F5; mt8KD: $maxLat = $lat + $dlat; goto Os2KC; qFl1a: $dlng = rad2deg($dlng); goto zcj3J; Os2KC: $minLng = $lng - $dlng; goto buP66; OxQQw: $minLat = $lat - $dlat; goto mt8KD; CuIZl: } } goto Hk2Ew; gyLz4: function roundImg($imgpath, $saveName = '') { goto D6xob; j1JWj: if (!($y < $h)) { goto goRY2; } goto jdZln; XarCD: $w = $h = min($w, $h); goto ju0NQ; oKQPb: $y = 0; goto d8cw5; T5ZCF: if ($saveName) { goto fidit; } goto f3whV; Yzcnx: $bg = imagecolorallocatealpha($img, 255, 255, 255, 127); goto x6CF_; kx7gJ: imagepng($img, $saveName); goto B2u_V; P7CFX: $h = imagesy($src_img); goto XarCD; vik1I: goto HMTr5; goto O3pap; x6CF_: imagefill($img, 0, 0, $bg); goto SXt6M; DGyMm: cmpA5: goto v_lWd; v_lWd: if (!($x < $w)) { goto j3oiF; } goto oKQPb; DZqy3: if (!(($x - $r) * ($x - $r) + ($y - $r) * ($y - $r) < $r * $r)) { goto aTB1l; } goto LMQh3; d8cw5: HMTr5: goto j1JWj; xslaI: goto cmpA5; goto I1npp; RHB60: aTB1l: goto g0CZA; D6xob: $src_img = imagecreatefromstring(file_get_contents($imgpath)); goto HA9x9; H1g1c: $y++; goto vik1I; H7glr: imagedestroy($img); goto G0hb2; B2u_V: imagedestroy($src_img); goto H7glr; I1npp: j3oiF: goto T5ZCF; g0CZA: FXP8H: goto H1g1c; HA9x9: $w = imagesx($src_img); goto P7CFX; p76ww: imagesavealpha($img, true); goto Yzcnx; ju0NQ: $img = imagecreatetruecolor($w, $h); goto Kg0rh; kEAyo: SNbqw: goto ksA_L; Kg0rh: imagealphablending($img, false); goto p76ww; jdZln: $rgbColor = imagecolorat($src_img, $x, $y); goto DZqy3; yCU7X: fidit: goto kx7gJ; LMQh3: imagesetpixel($img, $x, $y, $rgbColor); goto RHB60; SXt6M: $r = $w / 2; goto W87lH; W87lH: $x = 0; goto DGyMm; O3pap: goRY2: goto kEAyo; ksA_L: $x++; goto xslaI; f3whV: return $img; goto yCU7X; G0hb2: }