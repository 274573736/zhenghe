<?php
 defined("\x49\116\137\x49\101") or exit("\101\x63\143\x65\x73\x73\x20\x44\x65\156\151\x65\x64"); include IA_ROOT . "\x2f\x61\x64\144\157\156\163\57\x6d\141\x6b\x65\x5f\x73\160\145\x65\x64\x2f\145\x78\x74\x65\x6e\x64\57\143\x6f\155\x6d\157\156\56\x66\165\156\x63\x2e\x70\x68\160"; include "\x69\x6e\x69\x74\56\x70\150\160"; include "\145\170\x74\145\x6e\x64\x2f\x63\x6f\x6d\155\x6f\x6e\x2e\146\x75\156\143\56\x70\x68\160"; use Server\app\Token; use Server\DesignateDriver; use Mclass\GetRedis; class Make_riderModuleWxapp extends WeModuleWxapp { public function __construct() { goto I1Kr3; sqYxQ: if (!empty($GLOBALS["\103\x55\122\x52\x45\116\124\137\122\x49\104\x45\122"])) { goto h5CKj; } goto JOjWj; bWZNz: logging_run(date("\131\55\155\55\x64\x20\110\72\151") . "\x5b\122\x49\x44\105\122\40\103\x4c\111\105\116\x54\135\162\151\x64\145\x72\40\165\x6e\151\141\143\x69\x64\72\x20" . (string) $_W["\165\x6e\x69\x61\x63\151\144"], "\164\x72\x61\143\x65", "\155\141\x6b\x65\163\x70\x65\x65\x64\x6c\157\147"); goto SDgtX; SDgtX: $result = pdo_get("\155\141\153\x65\137\x73\160\145\145\144\x5f\x73\x65\164\x74\x69\156\x67", array("\x6b\x65\171" => "\162\x69\x64\x65\162\x5f\165\x6e\x69\x61\143\151\x64", "\166\x61\x6c\165\145" => $_W["\165\x6e\151\141\x63\151\x64"]), array("\165\x6e\151\141\x63\151\144")); goto IM99Z; uAftb: return $this->result(0, "\344\270\x8e\xe7\224\250\xe6\210\xb7\xe7\253\257\xe5\xb0\217\347\xa8\x8b\345\272\217\347\273\221\xe5\256\x9a\xe6\x9c\x89\350\257\257"); goto Map8F; WItyc: $GLOBALS["\103\x55\122\122\105\x4e\124\137\122\111\104\105\122"] = !empty($currentRider["\151\144"]) ? (int) $currentRider["\151\144"] : 0; goto iUeec; mk50s: $GLOBALS["\165\156\x69\x61\143\151\x64"] = $result["\165\x6e\x69\141\x63\x69\144"]; goto sqYxQ; pbsss: if (!($result["\x75\156\151\x61\x63\x69\x64"] == $_W["\165\156\151\x61\x63\x69\x64"])) { goto tWRu2; } goto uAftb; ewG72: GojXe: goto pbsss; I1Kr3: global $_W; goto nGQlp; f8tjo: return $this->result(0, "\xe6\x9c\xaa\xe4\xb8\x8e\347\x94\250\346\210\xb7\xe7\xab\xaf\xe5\260\x8f\xe7\xa8\213\xe5\xba\x8f\347\xbb\221\345\xae\x9a"); goto ewG72; Map8F: tWRu2: goto mk50s; JOjWj: $currentRider = pdo_get("\155\x61\x6b\145\x5f\x73\x70\145\145\x64\137\x72\151\144\145\162", array("\x6f\x70\145\156\x5f\x69\144" => $_W["\x6f\160\145\x6e\x69\144"], "\165\x6e\151\141\143\151\144" => $GLOBALS["\x75\156\x69\141\143\151\144"]), array("\151\x64")); goto WItyc; IM99Z: logging_run(date("\131\55\x6d\x2d\144\40\x48\x3a\151") . "\x5b\x52\111\x44\105\122\x20\103\114\111\105\116\124\x5d\40\x75\156\151\141\x63\x69\x64\x3a\x20" . (string) $result["\x75\x6e\x69\x61\x63\151\144"], "\164\162\x61\143\x65", "\x6d\141\x6b\145\163\x70\145\x65\144\154\x6f\147"); goto aF0ZV; aF0ZV: if (!empty($result["\165\x6e\x69\141\x63\151\x64"])) { goto GojXe; } goto f8tjo; iUeec: h5CKj: goto fYk3n; nGQlp: load()->func("\154\157\x67\147\151\156\147"); goto bWZNz; fYk3n: } public function doPageTokenExist() { $token = $this->request->param("\164\157\153\x65\156"); } public function doPageTest() { goto kZ8WI; TmwLQ: return $this->result(0, "\157\x6b", ["\x69\x64" => "\157\162\x64\x65\x72" . $order_id, "\160\x72\151\x63\x65" => $price, "\x64\x69\163\164\x61\156\143\x65" => $distance]); goto lrcGf; x6VbS: $coord = $designateDriver->getCoord($riderID); goto CmVEO; paM60: WjD1r: goto VJBYn; G7Eot: pdo_update("\x6d\x61\153\x65\x5f\163\160\145\x65\144\x5f\157\x72\144\145\x72", $price, ["\151\144" => $riderID]); goto j_lnh; kZ8WI: $riderID = $GLOBALS["\103\125\x52\122\x45\116\x54\137\x52\x49\104\x45\122"]; goto hejfu; t6EFw: y2LcW: goto Srt20; Cw9y3: $distance = $designateDriver->getTrackDistance($order_id); goto EeWfi; JEYHq: $price = countDestDriverPrice($distance); goto G7Eot; CmVEO: $redis = GetRedis::instance(); goto tXfGi; Srt20: $designateDriver->uploadCoord($order_id, $coord); goto Cw9y3; tXfGi: $order_id = $redis->get("\x64\162\x69\166\x65\162" . $riderID); goto HJ3aA; hejfu: $designateDriver = new DesignateDriver(); goto x6VbS; EeWfi: if ($distance) { goto WjD1r; } goto w3fqZ; EblEJ: msg("\xe6\x9c\xaa\xe8\257\273\xe5\217\226\345\x88\260\347\xbc\x93\345\255\x98\350\256\xa2\xe5\x8d\225"); goto t6EFw; w3fqZ: return $this->result(0, "\157\x6b", ["\x64\151\x73\x74\x61\x6e\143\145" => $distance]); goto paM60; VJBYn: loader()->func("\x44\x72\151\166\x65\x72"); goto JEYHq; j_lnh: try { @(\Server\Gateway::$registerAddress = "\61\62\67\56\x30\56\60\56\x31\72\x31\62\63\70"); @\Server\Gateway::sendToUid("\157\x72\x64\x65\162" . $order_id, json_encode(["\160\162\x69\143\x65" => $price, "\x74\x79\x70\x65" => "\162\145\x61\154\x5f\164\151\x6d\x65\137\160\x72\x69\143\x65"])); } catch (\Exception $e) { } goto TmwLQ; HJ3aA: if ($order_id) { goto y2LcW; } goto EblEJ; lrcGf: } public function payResult($param) { goto JZK8H; Jq_QZ: MkbQ0: goto o8wn8; r4qBh: switch ($pre) { case "\x52\103": $this->rcPayResult($param); goto yRL1g; case "\x45\117": $this->equipPayResult($param); goto yRL1g; default: goto yRL1g; } goto Jq_QZ; yJogi: $pre = substr($param["\x74\x69\x64"], 0, 2); goto r4qBh; o8wn8: yRL1g: goto yFK0X; JZK8H: global $_W; goto yJogi; yFK0X: } public function equipPayResult($param) { goto BGNKx; oRGZx: lQO8A: goto OS3i3; OSyEE: QRYuQ: goto oRGZx; BGNKx: if (!($param["\x72\x65\x73\165\x6c\164"] == "\163\x75\x63\x63\x65\x73\163")) { goto lQO8A; } goto Qw6fS; Qw6fS: $equip = pdo_get("\x6d\x61\x6b\x65\x5f\x73\x70\x65\145\x64\x5f\145\161\165\x69\x70\x5f\x6f\x72\144\x65\x72", array("\157\162\x64\145\162\137\x63\x6f\x64\x65" => $param["\164\x69\144"]), array("\x69\144", "\163\164\141\x74\x75\163")); goto rGhI3; rGhI3: if (!(!empty($equip) && $equip["\163\164\x61\164\165\x73"] < 1)) { goto QRYuQ; } goto FYA41; FYA41: pdo_update("\x6d\141\x6b\x65\137\x73\x70\145\x65\144\x5f\x65\161\165\151\x70\137\x6f\x72\x64\145\x72", array("\x73\x74\141\164\165\163" => 1), array("\x69\144" => $equip["\x69\x64"])); goto OSyEE; OS3i3: } private function rcPayResult($param) { goto utpSA; jB2Qy: pdo_update("\x6d\141\153\145\x5f\163\x70\x65\x65\144\137\162\x69\x64\145\x72\137\x63\x61\x73\x68\x6c\157\x67", array("\x73\x74\x61\x74\x75\163" => 2), array("\151\144" => $cash["\151\x64"])); goto LuEKo; UefCr: gZJ87: goto IIT_1; qtIf3: if (!(!empty($cash) && $cash["\x73\164\141\x74\x75\163"] < 2)) { goto qub8G; } goto jB2Qy; utpSA: if (!($param["\162\x65\x73\x75\x6c\164"] == "\163\x75\143\x63\x65\x73\x73")) { goto gZJ87; } goto QgorD; QgorD: $cash = pdo_get("\155\x61\x6b\x65\137\163\x70\145\145\144\x5f\x72\151\144\145\x72\137\143\x61\163\x68\x6c\x6f\147", array("\157\x72\144\145\162\137\x63\x6f\144\x65" => $param["\164\151\x64"]), array("\x69\x64", "\x72\151\144\145\162\137\x69\144", "\x73\164\141\164\165\x73", "\141\155\157\165\x6e\164")); goto qtIf3; LuEKo: updateRiderMoney($cash["\x72\x69\x64\145\162\137\x69\144"], $cash["\141\155\x6f\165\x6e\164"], 0); goto Zqqp6; Zqqp6: qub8G: goto UefCr; IIT_1: } }